{% extends 'base.html' %}

{% block content %}

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="http://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css"> 
<script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<body>
	<h1>{% block title %}Database{% endblock %}</h1>
	
	<div class="container">
		<div class="row">
			<div class="col-12 col-md-8" style="padding-top:0.65%">
				<table id="inference_table" class="table  table-striped" style="margin-left: auto;margin-right: auto">
					<thead>
						<tr role="row">
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>Longitude</b></th>
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>Latitude</b></th>
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>House Age</b></th>
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>Annual Income</b></th>
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>Inland</b></th>
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>Near Ocean</b></th>
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>Near Bay</b></th>
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>Number of Rooms</b></th>
							<th class="sorting" tabindex="0" aria-controls="inference_table" rowspan="1" colspan="1" aria-label="Application No: activate to sort column ascending" style="width: 130px;text-align:center"><b>Price Prediction</b></th>
						</tr>
					</thead>

					<tbody>
						<script>
							var got_data = [
												{'longitude': '123', 'latitude': '23213','house_age': '2313', 'annual_income': '125.60', 'inland': '1', 'near_ocean': '0', 'near_bay': '1', 'number_of_rooms': '4', 'price_prediction': '23123'},
												{'longitude': '123', 'latitude': '545666','house_age': '2313', 'annual_income': '125.60', 'inland': '1', 'near_ocean': '0', 'near_bay': '1', 'number_of_rooms': '4', 'price_prediction': '23123'}
											]
											
							for (var i = 0; i < got_data.length; i++) {
								document.write('<tr>');
									document.write('<td>' + got_data[i].longitude + '</td>');
									document.write('<td>' + got_data[i].latitude + '</td>');
									document.write('<td>' + got_data[i].house_age + '</td>');
									document.write('<td>' + got_data[i].annual_income + '</td>');
									document.write('<td>' + got_data[i].inland + '</td>');
									document.write('<td>' + got_data[i].near_ocean + '</td>');
									document.write('<td>' + got_data[i].near_bay + '</td>');
									document.write('<td>' + got_data[i].number_of_rooms + '</td>');
									document.write('<td>' + got_data[i].price_prediction + '</td>');
								document.write('</tr>');
							}			
						</script>
												
					</tbody>
				</table>

				<script>
					$(document).ready(function ()
					{
						$('#inference_table').DataTable(
						{
							"paging": false // false to disable search (or any other option)
						});
						$('.dataTables_length').addClass('bs-select');
					});
				</script>
										
				
										
				
			</div>
			<div class="col-6 col-md-4" style="padding-top:0.65%">
				<button class="btn btn-primary" type="submit">Download CSV</button>
				<script>
					function download_csv(html, filename) {
						var csv = [];
						var rows = document.querySelectorAll("table tr");

						for (var i = 0; i < rows.length; i++) {
							var row = [],
							cols = rows[i].querySelectorAll("td, th");

							for (var j = 0; j < cols.length; j++)
								row.push(cols[j].innerText);
								
								csv.push(row.join(","));
						}

						csv = csv.join("\n");
						var csvFile;
						var downloadLink;

						csvFile = new Blob([csv], {
							type: "text/csv"
						});

						downloadLink = document.createElement("a");
						downloadLink.download = filename;
						downloadLink.href = window.URL.createObjectURL(csvFile);
						downloadLink.style.display = "none";
						document.body.appendChild(downloadLink);
						downloadLink.click();
					}

					document.querySelector("button").addEventListener("click", function() {
						var html = document.querySelector("table").outerHTML;
						download_csv(html, "table.csv");
					});
				</script>
			</div>
		</div>
	</div>
</body>
{% endblock %}
